<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulating data with CONSURE • CONSURE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simulating data with CONSURE">
<meta property="og:description" content="CONSURE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CONSURE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/SimulatingDataWithCONSURE.html">SimulatingDataWithCONSURE</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SaskiaSchirmer/CONSURE/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="SimulatingDataWithCONSURE_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Simulating data with CONSURE</h1>
                        <h4 class="author">Saskia Schirmer</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SaskiaSchirmer/CONSURE/blob/master/vignettes/SimulatingDataWithCONSURE.Rmd"><code>vignettes/SimulatingDataWithCONSURE.Rmd</code></a></small>
      <div class="hidden name"><code>SimulatingDataWithCONSURE.Rmd</code></div>

    </div>

    
    
<div id="simulating-data-with-consure" class="section level1">
<h1 class="hasAnchor">
<a href="#simulating-data-with-consure" class="anchor"></a>Simulating data with CONSURE</h1>
<p>If you do not want to simulate data, but estimate parameters for your data, you can skip this vignette and rather read the vignette on <a href="EstimatingParameters.html">how to estimate parameters</a> or <a href="workingWithRealWorldData.html">how to work with real-world data</a>. Nevertheless, this vignette may help you to understand the background of how this package works.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SaskiaSchirmer/CONSURE">CONSURE</a></span><span class="op">)</span></code></pre></div>
<div id="one-dimensional-non-breeding-space" class="section level2">
<h2 class="hasAnchor">
<a href="#one-dimensional-non-breeding-space" class="anchor"></a>One-dimensional non-breeding space</h2>
<div id="initializing-the-markrecaptureobject" class="section level3">
<h3 class="hasAnchor">
<a href="#initializing-the-markrecaptureobject" class="anchor"></a>Initializing the markRecaptureObject</h3>
<p>To simulate data in one-dimensional space, we specify the number of breeding areas and the spatial resolution.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">5</span>    <span class="co"># number of breeding areas</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># spatial resolution (number of grid points along the x-axis)</span></code></pre></div>
<p>Then, we specify an object of the class markRecaptureObject.</p>
<ul>
<li>We define the wintering area (w) as a segment between 0 and 1 using the argument xrange.</li>
<li>The survival function is a continuous function varying along the one-dimensional wintering area (x-axis), but must be less than 1 in every point in space. We choose a linear increasing function s(w) = 0.5w + 0.4.</li>
<li>The recovery probability is necessarily a constant over space. We set it to 0.01.</li>
<li>The migratory connectivity must be defined as a function for every breeding area. This function is a continuous function varying across space but must integrate to 1 over the whole space. As this is the characteristic of a probability density function, we choose a truncated normal distribution with a different mean for every breeding area.</li>
<li>In this example the number of marked individuals per breeding area is equal for all areas. They can also differ between breeding areas but the number should not be too small if results should be representative.</li>
<li>We set the observation time to 10, e.g., the 10 years after a marking of an animal.</li>
<li>We decide if we want to use robust estimators to estimate survival and migratory connectivity. The default is to use a robust estimator. Robust estimation is robust against outliers and may give better results when there is not much data. The ordinary estimator (robust = FALSE) is a bit more smooth and may perform better, when sparse data leads to large gaps in the values, so that some data points may look like outliers but are none. One could think of a dataset of 50 individuals, all aged 1 to 3 and one single individual aged 16. If the sample size would be 10000, there should also be individuals aged 4 to 15, but because of the small sample size they just do not occur. So, the 16 year-old individual looks like an outlier but is none. In this case, the ordinary estimator would perform better. Nevertheless, someone may have made a typo in the data and it is a outlier and the robust estimator would perform better. So, it might be tricky to decide which estimator performs better.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mro</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/markRecaptureObject.html">markRecaptureObject</a></span><span class="op">(</span>xrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,
                    survival <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">{</span><span class="fl">0.5</span><span class="op">*</span><span class="va">w</span><span class="op">+</span><span class="fl">.4</span><span class="op">}</span>,
                    recovery <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">{</span><span class="fl">0.01</span><span class="op">}</span>,
                    migratoryConnectivity <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">b</span>,<span class="va">w</span>,<span class="va">B</span><span class="op">=</span><span class="va">B</span><span class="op">)</span><span class="op">{</span>
                      <span class="fu">truncnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/truncnorm/man/dtruncnorm.html">dtruncnorm</a></span><span class="op">(</span><span class="va">w</span>,<span class="fl">0</span>,<span class="fl">1</span>, 
                                            mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.9</span>,length.out <span class="op">=</span> <span class="va">B</span><span class="op">)</span><span class="op">[</span><span class="va">b</span><span class="op">]</span>, 
                                            sd <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">}</span>,
                    markedInds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">100000</span>,<span class="va">B</span><span class="op">)</span>,
                    observationTime <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>The true parameters of the simulated data looks like the following:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotMsr.html">plotMsr</a></span><span class="op">(</span><span class="va">mro</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="SimulatingDataWithCONSURE_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>The black lines are the migratory connectivity distributions where different line types indicate different breeding areas. The red solid line is the survival function. The green constant line is the recovery probability. The blue solid line is the overall mortality during the observation times. This means 1- survival to the power of the observation time.</p>
</div>
<div id="the-structure-of-the-markrecaptureobject" class="section level3">
<h3 class="hasAnchor">
<a href="#the-structure-of-the-markrecaptureobject" class="anchor"></a>The structure of the markRecaptureObject</h3>
<p>The structure of the initialized markRecaptureObject looks like the following:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mro</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; List of 9</span>
<span class="co">#&gt;  $ winteringArea        :List of 4</span>
<span class="co">#&gt;   ..- attr(*, "class")= chr "winteringArea"</span>
<span class="co">#&gt;  $ breedingAreas        :List of 6</span>
<span class="co">#&gt;  $ observationTime      : num 10</span>
<span class="co">#&gt;  $ numberOfBreedingAreas: int 5</span>
<span class="co">#&gt;  $ spatialDim           : num 1</span>
<span class="co">#&gt;  $ spatialResolution    : NULL</span>
<span class="co">#&gt;  $ robust               : logi TRUE</span>
<span class="co">#&gt;  $ kde                  : list()</span>
<span class="co">#&gt;  $ estimates            : list()</span>
<span class="co">#&gt;  - attr(*, "class")= chr "markRecaptureObject"</span></code></pre></div>
<p>The markRecaptureObject consists of an object of the class winteringAreaObject, an object of the class breedingAreaObject and information on the observation time, the number of breeding areas, the spatial dimension of the wintering area and the spatial resolution. The spatial dimension must not be predefined but will be extracted automatically. The spatial resolution is only needed for estimates and plots of these and will be defined later. Besides these, the markRecaptureObject contains predefined list entries for the kernel density estimate and the estimates of the model parameters.</p>
<p>The winteringAreaObject in detail looks like the following:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mro</span><span class="op">$</span><span class="va">winteringArea</span><span class="op">)</span>
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ window      :List of 4</span>
<span class="co">#&gt;   ..$ type  : chr "rectangle"</span>
<span class="co">#&gt;   ..$ xrange: num [1:2] 0 1</span>
<span class="co">#&gt;   ..$ yrange: num [1:2] 0 0</span>
<span class="co">#&gt;   ..$ units :List of 3</span>
<span class="co">#&gt;   .. ..$ singular  : chr "unit"</span>
<span class="co">#&gt;   .. ..$ plural    : chr "units"</span>
<span class="co">#&gt;   .. ..$ multiplier: num 1</span>
<span class="co">#&gt;   .. ..- attr(*, "class")= chr "unitname"</span>
<span class="co">#&gt;   ..- attr(*, "class")= chr "owin"</span>
<span class="co">#&gt;  $ survival    :function (w)  </span>
<span class="co">#&gt;   ..- attr(*, "srcref")= 'srcref' int [1:8] 2 32 2 52 32 52 2 2</span>
<span class="co">#&gt;   .. ..- attr(*, "srcfile")=Classes 'srcfilecopy', 'srcfile' &lt;environment: 0x556b5b1ce328&gt; </span>
<span class="co">#&gt;  $ recovery    :function (w)  </span>
<span class="co">#&gt;   ..- attr(*, "srcref")= 'srcref' int [1:8] 3 32 3 48 32 48 3 3</span>
<span class="co">#&gt;   .. ..- attr(*, "srcfile")=Classes 'srcfilecopy', 'srcfile' &lt;environment: 0x556b5b1ce328&gt; </span>
<span class="co">#&gt;  $ recoveryData: NULL</span>
<span class="co">#&gt;  - attr(*, "class")= chr "winteringArea"</span></code></pre></div>
<p>In one-dimensional space defining an interval on a line via “xrange” is sufficient. In two-dimensional space the wintering area can be either defined as a rectangle using “xrange” and “yrange” or as a window. Therefore, the window is always a two-dimensional object. It is an owin-object from the spatstat.geom-package. Survival and recovery probability are independent of the breeding origin. They contain the true functions defined in the initializing step. The list entry recoveryData can be filled by real-world recovery data in the initializing step (see vignette for real-world data) or by simulated recovery data (see next section).</p>
<p>The list of one single breeding area is named by the name of the breeding area. By default the name is “b” and a consecutive number for all other breeding areas. It contains</p>
<ul>
<li>the number of marked individuals of this breeding area (markedInds),</li>
<li>the number of recoveries, which will be filled automatically when recovery data is added to the markRecaptureObject,</li>
<li>the true migratory connectivity function if available (e.g., for simulated data) and</li>
<li>the recovery data belonging to this breeding area. For simulated data this will be filled, when the data is simulated (see next section). For real-world data the recovery data is forwarded with the initialization of the markRecaptureObject (see vignette for real-world data).</li>
</ul>
</div>
<div id="simulating-data-from-a-markrecaptureobject" class="section level3">
<h3 class="hasAnchor">
<a href="#simulating-data-from-a-markrecaptureobject" class="anchor"></a>Simulating data from a markRecaptureObject</h3>
<p>Simulating data following the specification of the markRecaptureObject can be done using the function simContin. The simulated data corresponds to the dead recoveries at a spatial coordinate in the wintering area. Each dead recovery belongs to a breeding area and has a known age at death. The output is again a markRecaptureObject additionally storing the simulated data. It can be saved under the same name as the initializing markRecaptureObject.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mro</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simContin.html">simContin</a></span><span class="op">(</span><span class="va">mro</span><span class="op">)</span>
<span class="co">#&gt; Registered S3 method overwritten by 'cli':</span>
<span class="co">#&gt;   method     from         </span>
<span class="co">#&gt;   print.boxx spatstat.geom</span></code></pre></div>
<p>The simulated data is stored both split by the wintering area and split by the breeding area and can be used according to which split is needed. The structure of the wintering area looks like this:</p>
<p>For every breeding area exists a matrix with the longitude (which represents the only spatial coordinate) and the time of each dead recovery.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mro</span><span class="op">$</span><span class="va">winteringArea</span><span class="op">$</span><span class="va">recoveryData</span><span class="op">$</span><span class="va">b1</span><span class="op">)</span>
<span class="co">#&gt;   markArea  longitude age</span>
<span class="co">#&gt; 1       b1 0.35661424   1</span>
<span class="co">#&gt; 2       b1 0.06869023   2</span>
<span class="co">#&gt; 3       b1 0.42779738   3</span>
<span class="co">#&gt; 4       b1 0.45303889   2</span>
<span class="co">#&gt; 5       b1 0.12429906   1</span>
<span class="co">#&gt; 6       b1 0.57693476   3</span></code></pre></div>
</div>
</div>
<div id="two-dimensional-non-breeding-space" class="section level2">
<h2 class="hasAnchor">
<a href="#two-dimensional-non-breeding-space" class="anchor"></a>Two-dimensional non-breeding space</h2>
<div id="initializing-the-markrecaptureobject-1" class="section level3">
<h3 class="hasAnchor">
<a href="#initializing-the-markrecaptureobject-1" class="anchor"></a>Initializing the markRecaptureObject</h3>
<p>Initializing a markRecaptureObject in two-dimensional space equals the initializing step in one-dimensional space. The only difference is that the wintering area is a rectangle (or a two-dimensional window) and a point w is now a two-dimensional vector with x- and y-coordinate. Therefore, we also must specify yrange for the rectangle and the the survival and migratory connectivity function must be two-dimensional. In the example below we choose survival probability as a plane linearly decreasing from the origin to the point (1,1). For the migratory connectivity function we choose the probability density function of a truncated bivariate normal distribution with different means for the different breeding areas. This function integrates to 1 over the whole non-breeding area by definition. The recovery probability remains a constant over the whole non-breeding space.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mro2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/markRecaptureObject.html">markRecaptureObject</a></span><span class="op">(</span>xrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,
                            yrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,
                            survival <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">{</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">*</span><span class="va">w</span><span class="op">)</span><span class="op">+</span><span class="fl">0.9</span><span class="op">}</span>,
                            recovery <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">{</span><span class="fl">0.01</span><span class="op">}</span>,
                            markedInds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">100000</span>,<span class="va">B</span><span class="op">)</span> ,
                            migratoryConnectivity <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">b</span>,<span class="va">w</span>,<span class="va">lb</span><span class="op">=</span><span class="fl">0</span>,<span class="va">ub</span><span class="op">=</span><span class="fl">1</span>,<span class="va">B</span><span class="op">=</span><span class="va">B</span><span class="op">)</span><span class="op">{</span>
                              <span class="fu">tmvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tmvtnorm/man/tmvnorm.html">dtmvnorm</a></span><span class="op">(</span><span class="va">w</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.9</span>,length.out <span class="op">=</span> <span class="va">B</span><span class="op">)</span><span class="op">[</span><span class="va">b</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>,
                                                 sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">2</span><span class="op">)</span>, lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">lb</span>,<span class="fl">2</span><span class="op">)</span>,
                                                 upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">ub</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
                            <span class="op">}</span>,
                            observationTime <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>The true values look like the following:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotMsr.html">plotMsr</a></span><span class="op">(</span><span class="va">mro2</span><span class="op">)</span></code></pre></div>
<p><img src="SimulatingDataWithCONSURE_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>The black contours are the migratory connectivity distributions where different line types indicate different breeding areas. The red solid contours is the survival function. The blue solid contours is the overall mortality during the observation times. This means 1- survival to the power of the observation time. The recovery probability is not shown here as it is just a constant plane at 0.01.</p>
</div>
<div id="the-structure-of-the-markrecaptureobject-1" class="section level3">
<h3 class="hasAnchor">
<a href="#the-structure-of-the-markrecaptureobject-1" class="anchor"></a>The structure of the markRecaptureObject</h3>
<p>The structure of the markRecaptureObject remains exactly the same as in one-dimensional non-breeding space</p>
</div>
<div id="simulating-data-from-the-markrecaptureobject" class="section level3">
<h3 class="hasAnchor">
<a href="#simulating-data-from-the-markrecaptureobject" class="anchor"></a>Simulating data from the markRecaptureObject</h3>
<p>Simulating data remains the same as in one-dimensional space:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mro2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simContin.html">simContin</a></span><span class="op">(</span><span class="va">mro2</span><span class="op">)</span></code></pre></div>
<p>In contrast to data in one-dimensional space the simulated dead recoveries in two-dimensional space are stored in a matrix with three columns. One for the latitude, one for the longitude and one for the time of each dead recovery:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mro2</span><span class="op">$</span><span class="va">winteringArea</span><span class="op">$</span><span class="va">recoveryData</span><span class="op">$</span><span class="va">b1</span><span class="op">)</span>
<span class="co">#&gt;   markArea longitude  latitude age</span>
<span class="co">#&gt; 1       b1 0.4861081 0.2076185   1</span>
<span class="co">#&gt; 2       b1 0.5398212 0.9130435   1</span>
<span class="co">#&gt; 3       b1 0.7537778 0.5984288   1</span>
<span class="co">#&gt; 4       b1 0.5335912 0.2022777   1</span>
<span class="co">#&gt; 5       b1 0.1777884 0.8185445   1</span>
<span class="co">#&gt; 6       b1 0.5482583 0.4057414   1</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/SaskiaSchirmer">Saskia Schirmer</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
