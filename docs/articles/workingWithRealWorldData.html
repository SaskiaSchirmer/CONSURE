<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with real-world data • CONSURE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Working with real-world data">
<meta property="og:description" content="A real-world example on how to apply CONSURE, when the data is not simulated">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CONSURE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/SimulatingDataWithCONSURE.html">SimulatingDataWithCONSURE</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SaskiaSchirmer/CONSURE/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="workingWithRealWorldData_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Working with real-world data</h1>
                        <h4 class="author">Saskia Schirmer</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SaskiaSchirmer/CONSURE/blob/master/vignettes/workingWithRealWorldData.Rmd"><code>vignettes/workingWithRealWorldData.Rmd</code></a></small>
      <div class="hidden name"><code>workingWithRealWorldData.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SaskiaSchirmer/CONSURE">CONSURE</a></span><span class="op">)</span></code></pre></div>
<p>The example data set is a real-world data set of European robins. They are marked during autumn migration at a stopover site. The breeding origin is unknown but we assume that different breeding populations migrate at different times. Therefore, we partition the data sets in early, intermediate and late passing birds and assume that early, intermediate and late migrating individuals origin from different breeding areas. The data set only includes dead recoveries made between November and February, when we assume the robins to have arrived in their wintering areas.</p>
<p>Working with real-world data in the CONSURE-package is easy if the data has the right format. Therefore, we need to check the structure of the data. We load the data and look at the structure:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"robinsInit"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">robinsInit</span>, max.level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ markData       :'data.frame': 3 obs. of  2 variables:</span>
<span class="co">#&gt;   ..$ markArea  : chr [1:3] "early" "medium" "late"</span>
<span class="co">#&gt;   ..$ markedInds: num [1:3] 34177 32389 31833</span>
<span class="co">#&gt;  $ recoveryData   :'data.frame': 48 obs. of  4 variables:</span>
<span class="co">#&gt;   ..$ markArea: Factor w/ 3 levels "early","late",..: 2 2 2 2 2 2 2 1 2 2 ...</span>
<span class="co">#&gt;   ..$ recLat  : num [1:48] 54.3 52.6 55.7 53.8 53.1 ...</span>
<span class="co">#&gt;   ..$ recLon  : num [1:48] 13.7 13.4 14 12.5 13.6 ...</span>
<span class="co">#&gt;   ..$ age     : int [1:48] 1 2 1 1 1 1 2 1 2 2 ...</span>
<span class="co">#&gt;  $ window         :List of 5</span>
<span class="co">#&gt;   ..$ type  : chr "polygonal"</span>
<span class="co">#&gt;   ..$ xrange: num [1:2] -15 30</span>
<span class="co">#&gt;   ..$ yrange: num [1:2] 30 65</span>
<span class="co">#&gt;   ..$ bdry  :List of 18</span>
<span class="co">#&gt;   ..$ units :List of 3</span>
<span class="co">#&gt;   .. ..- attr(*, "class")= chr "unitname"</span>
<span class="co">#&gt;   ..- attr(*, "class")= chr "owin"</span>
<span class="co">#&gt;  $ observationTime: num 5</span></code></pre></div>
<p>The data must provide information on the marked individuals and the dead recoveries. For that it must contain:</p>
<ul>
<li>a data.frame for the marked individuals with one row per breeding area and columns for
<ul>
<li>the name of the breeding area (here: “markArea”, you can use any column name, see below for details)</li>
<li>the number of marked individuals per breeding area (here: “markedInds”)</li>
</ul>
</li>
<li>a data.frame with one row per recovered individual and columns for
<ul>
<li>geographical coordinates (longitude and latitude in two-dimensional non-breeding space) of the dead recoveries (here: “recLon” and “recLat”)</li>
<li>the breeding origin of the dead recovery (here: “markArea”)</li>
<li>the age at death of the breeding origin (here: “age”)</li>
</ul>
</li>
<li>the observation time. This is just one number. E.g., when a study took place over 3 years, the observation time is 3 (here: “observationTime”).</li>
<li>the shape of the non-breeding area. A minimal solution would be a rectangle around the assumed non-breeding area or the dead recoveries. Ideally, it is an owin-object with the outlines of the map in the relevant non-breeding area (here: “window”).</li>
</ul>
<p>If we choose custom column names, we have different options to tell CONSURE, which column is which. As we will see later, this is only a problem for the data frame of dead recoveries, not for the data frame of marked individuals. We need to be careful and tell CONSURE which information is in which column. The following options exist: * The columns can be named by the default names “longitude”, “latitude”, “age”, “markArea”. * The names of the columns can be forwarded to a specific function. The arguments in the functions are * xname: longitude * yname: latitude * timename: age * markAreaName: markArea * The names of the columns can be forwarded one time to the renameData function, which gives back a data.frame with the default column names.</p>
<p>As we see by the structure output above, the example data set is not named by the default column names.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">robinsInit</span><span class="op">$</span><span class="va">recoveryData</span><span class="op">)</span>
<span class="co">#&gt; [1] "markArea" "recLat"   "recLon"   "age"</span></code></pre></div>
<p>We rename it using the function renameData and overwrite the data.frame of dead recoveries by the renamed data.frame</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">robinsInit</span><span class="op">$</span><span class="va">recoveryData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/renameData.html">renameData</a></span><span class="op">(</span>recoveryData <span class="op">=</span> <span class="va">robinsInit</span><span class="op">$</span><span class="va">recoveryData</span>, 
                                      xname <span class="op">=</span> <span class="st">"recLon"</span>, 
                                      yname <span class="op">=</span> <span class="st">"recLat"</span>, 
                                      timename <span class="op">=</span> <span class="st">"age"</span>, 
                                      markAreaName <span class="op">=</span> <span class="st">"markArea"</span><span class="op">)</span></code></pre></div>
<p>Now, the data.frame has the default column names:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">robinsInit</span><span class="op">$</span><span class="va">recoveryData</span><span class="op">)</span>
<span class="co">#&gt; [1] "markArea"  "latitude"  "longitude" "age"</span></code></pre></div>
<p>The order of the columns is not important. The functions in CONSURE only work on the names of the variables. The constructor of the markRecaptureObject throws a message, if the column names do not equal the default values.</p>
<div id="initializing-the-markrecaptureobject" class="section level2">
<h2 class="hasAnchor">
<a href="#initializing-the-markrecaptureobject" class="anchor"></a>Initializing the markRecaptureObject</h2>
<p>Now, we can initialize the markRecaptureObject:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/markRecaptureObject.html">markRecaptureObject</a></span><span class="op">(</span>window <span class="op">=</span> <span class="va">robinsInit</span><span class="op">$</span><span class="va">window</span>,
                           realRecoveries <span class="op">=</span> <span class="va">robinsInit</span><span class="op">$</span><span class="va">recoveryData</span>,
                           markedInds <span class="op">=</span> <span class="va">robinsInit</span><span class="op">$</span><span class="va">markData</span><span class="op">$</span><span class="va">markedInds</span>,
                           observationTime <span class="op">=</span> <span class="va">robinsInit</span><span class="op">$</span><span class="va">observationTime</span>,
                           breedingAreaNames <span class="op">=</span> <span class="va">robinsInit</span><span class="op">$</span><span class="va">markData</span><span class="op">$</span><span class="va">markArea</span><span class="op">)</span></code></pre></div>
<p>The method estimates a robust linear model to estimate the parameters. If an ordinary linear model should be estimated instead, the argument robust must be set to FALSE when initializing the markRecaptureObject.</p>
</div>
<div id="looking-at-the-raw-data" class="section level2">
<h2 class="hasAnchor">
<a href="#looking-at-the-raw-data" class="anchor"></a>Looking at the raw data</h2>
<p>We can look at the pattern of the raw recoveries and check if e.g., the window matches with the pattern:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotRawRecoveries.html">plotRawRecoveries</a></span><span class="op">(</span><span class="va">rwd</span><span class="op">)</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain-background/3/3/2.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain-background/3/4/2.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain-background/3/3/3.png</span>
<span class="co">#&gt; Source : http://tile.stamen.com/terrain-background/3/4/3.png</span></code></pre></div>
<p><img src="workingWithRealWorldData_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>We can also get a hint, if there is enough data for the estimation process. For example, there should be data points in every age class:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotRawRecoveries.html">plotRawRecoveries</a></span><span class="op">(</span><span class="va">rwd</span>, facetByAge <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="workingWithRealWorldData_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>and there should be data points (= dead recoveries) for every area of marking considered in the data set. (That does not mean, that there must be dead recoveries of every possible breeding area of the species). If there are no dead recoveries for a breeding area, we may consider to omit this breeding area or to join breeding areas, if this seems to be appropriate, e.g., because it lies inside or very close to another breeding area.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotRawRecoveries.html">plotRawRecoveries</a></span><span class="op">(</span><span class="va">rwd</span>, facetByArea <span class="op">=</span> <span class="cn">TRUE</span>, areaNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"early"</span>,<span class="st">"medium"</span>,<span class="st">"late"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="workingWithRealWorldData_files/figure-html/unnamed-chunk-9-1.png" width="384"></p>
<p>We can also look at plots for every breeding area and age class. One assumption of the model is, that survival and recovery probability does not depend on the origin of the animal. So, think carefully about the interpretation: Only if there are recoveries in the same wintering area originating from different breeding areas, the point pattern created by the recoveries should change in a similar way from age class to age class. If the recoveries of different breeding areas occur in different wintering areas, the pattern may look quite different between the age classes without violating the model assumption. Also small sample sizes may cover similar as well as dissimilar point patterns. In the case of the example data, the data set is small and therefore, results should be treated with care.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotRawRecoveries.html">plotRawRecoveries</a></span><span class="op">(</span><span class="va">rwd</span>, facetByAge <span class="op">=</span> <span class="cn">TRUE</span>, facetByArea <span class="op">=</span> <span class="cn">TRUE</span>, 
                  areaNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"early"</span>,<span class="st">"medium"</span>,<span class="st">"late"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="workingWithRealWorldData_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
<div id="estimating-survival" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-survival" class="anchor"></a>Estimating survival</h2>
<p>For estimating survival we must estimate the kernel density of the aggregated dataset. We choose the aggregated dataset by setting all to TRUE. The estKDE-function also specifies the spatial resolution for the estimation process. The default value is a resolution of 100. If you want another resolution, set the argument res to the value. The kernel density estimator automatically calculates a fixed bandwidth in space. It can be specified to another value by setting the argument bw. The temporal bandwidth defaults to 1.1. This oversmooths age classes which differ by one year slightly. It can be changed by setting the argument lam.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estKDE.html">estKDE</a></span><span class="op">(</span><span class="va">rwd</span>,all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Calculating trivariate smooth...Done.</span>
<span class="co">#&gt; Edge-correcting...Done.</span>
<span class="co">#&gt; Conditioning on time...Done.</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotKDE.html">plotKDE</a></span><span class="op">(</span><span class="st">"all"</span>,<span class="va">rwd</span><span class="op">)</span></code></pre></div>
<p><img src="workingWithRealWorldData_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>Now, survival is estimated by applying a linear model to the logarithm of the kernel density in every point of the map across all age classes. So the model is log-linear in age. The survival estimator is the exponential of the slope of the linear model. It can be estimated by the function estS:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estS.html">estS</a></span><span class="op">(</span>markRecaptureObject <span class="op">=</span> <span class="va">rwd</span><span class="op">)</span></code></pre></div>
<p>The plot is made with plotS. If not all values between 0 and 1 are taken on, zlim can be set to specific value to obtain a clearer view of the survival pattern.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotS.html">plotS</a></span><span class="op">(</span><span class="va">rwd</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="workingWithRealWorldData_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
</div>
<div id="estimating-the-migratory-connectivity-of-the-aggregated-dataset-and-the-recovery-probability" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-the-migratory-connectivity-of-the-aggregated-dataset-and-the-recovery-probability" class="anchor"></a>Estimating the migratory connectivity of the aggregated dataset and the recovery probability</h2>
<p>To be able to estimate the recovery probability we need to estimate the migratory connectivity of the aggregated dataset.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estM.html">estM</a></span><span class="op">(</span><span class="va">rwd</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>The plot of the aggregated migratory connectivity also gives an insight into the distribution of the considered subpopulation of the species.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotM.html">plotM</a></span><span class="op">(</span><span class="va">rwd</span>, <span class="st">"all"</span><span class="op">)</span></code></pre></div>
<p><img src="workingWithRealWorldData_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
<p>The recovery probability is the constant which ensures the migratory connectivity to integrate to 1 over the whole non-breeding area. It can be estimated by the function estR and just returns a constant value:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estR.html">estR</a></span><span class="op">(</span><span class="va">rwd</span><span class="op">)</span>
<span class="va">rwd</span><span class="op">$</span><span class="va">estimates</span><span class="op">$</span><span class="va">r</span>
<span class="co">#&gt; [1] 0.0005363178</span></code></pre></div>
<div id="estimating-the-migratory-connectivity-for-each-breeding-area" class="section level3">
<h3 class="hasAnchor">
<a href="#estimating-the-migratory-connectivity-for-each-breeding-area" class="anchor"></a>Estimating the migratory connectivity for each breeding area</h3>
<p>To obtain the migratory connectivity for each breeding area, we need to estimate the kernel density for each breeding area separately. The separate kernel is estimated for each kernel density if the argument all is FALSE, which is its default value.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estKDE.html">estKDE</a></span><span class="op">(</span><span class="va">rwd</span><span class="op">)</span>
<span class="co">#&gt; [1] 3.869201</span>
<span class="co">#&gt; Calculating trivariate smooth...Done.</span>
<span class="co">#&gt; Edge-correcting...Done.</span>
<span class="co">#&gt; Conditioning on time...Done.</span>
<span class="co">#&gt; [1] 2.193333</span>
<span class="co">#&gt; Calculating trivariate smooth...Done.</span>
<span class="co">#&gt; Edge-correcting...Done.</span>
<span class="co">#&gt; Conditioning on time...Done.</span>
<span class="co">#&gt; [1] 3.232601</span>
<span class="co">#&gt; Calculating trivariate smooth...Done.</span>
<span class="co">#&gt; Edge-correcting...Done.</span>
<span class="co">#&gt; Conditioning on time...Done.</span></code></pre></div>
<p>The kernel density estimate can be visualized for a specific breeding area with the plotKDE-function.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotKDE.html">plotKDE</a></span><span class="op">(</span><span class="st">"early"</span>,<span class="va">rwd</span><span class="op">)</span></code></pre></div>
<p><img src="workingWithRealWorldData_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<p>Now, a linear model is fitted to the kernel density values across all age classes in every point of the non-breeding area. This time the slope is fixed to the slope of the linear model for the aggregated dataset. The migratory connectivity is part of the intercept of the linear model and can be estimated using the function estM. It will be estimated for each breeding area separately if the argument all is set to FALSE, which is its default value.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estM.html">estM</a></span><span class="op">(</span><span class="va">rwd</span><span class="op">)</span></code></pre></div>
<p>The migratory connectivity of a specific breeding area can be plotted with the plotM-function:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotM.html">plotM</a></span><span class="op">(</span><span class="va">rwd</span>, <span class="st">"early"</span><span class="op">)</span></code></pre></div>
<p><img src="workingWithRealWorldData_files/figure-html/unnamed-chunk-21-1.png" width="576"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotM.html">plotM</a></span><span class="op">(</span><span class="va">rwd</span>, <span class="st">"medium"</span><span class="op">)</span></code></pre></div>
<p><img src="workingWithRealWorldData_files/figure-html/unnamed-chunk-22-1.png" width="576"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotM.html">plotM</a></span><span class="op">(</span><span class="va">rwd</span>, <span class="st">"late"</span><span class="op">)</span></code></pre></div>
<p><img src="workingWithRealWorldData_files/figure-html/unnamed-chunk-23-1.png" width="576"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/SaskiaSchirmer">Saskia Schirmer</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
